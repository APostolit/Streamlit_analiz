import streamlit as st
import pandas as pd

st.subheader('üêº–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ PivotTables –≤ Pandas')
# –°–æ–∑–¥–∞–µ–º –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
t1, t2, t3, t4, t5 = st.tabs(
    ["üì∂–ò—Å—Ö–æ–¥–Ω—ã–π DataFrame",
     "üçé–ü–æ –ø—Ä–æ–¥—É–∫—Ç—É",
     "üõçÔ∏è–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
     "üõçÔ∏èüçé–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç—É",
     "üßæüõç–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π",
     ])

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
df = pd.DataFrame({'–ü—Ä–æ–¥—É–∫—Ç—ã': ['–ú–æ—Ä–∫–æ–≤—å', '–ö–∞–ø—É—Å—Ç–∞', '–Ø–±–ª–æ–∫–∏', '–ì—Ä—É—à–∏'],
                   '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏': ['–û–≤–æ—â–∏', '–û–≤–æ—â–∏', '–§—Ä—É–∫—Ç—ã', '–§—Ä—É–∫—Ç—ã'],
                   '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ': [8, 5, 3, 4],
                   '–°—É–º–º–∞': [270, 239, 617, 384]})

# –í–∫–ª–∞–¥–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
with t1:
    st.subheader('üì∂–ò—Å—Ö–æ–¥–Ω—ã–π DataFrame')
    # –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    with st.container(width=500):
        st.dataframe(df)

# –í–∫–ª–∞–¥–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
with t2:
    st.subheader('üçé–°—É–º–º–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É')
    # –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    with st.container(width=300):
        pivot = df.pivot_table(index=['–ü—Ä–æ–¥—É–∫—Ç—ã'],
                               values=['–°—É–º–º–∞'],
                               aggfunc='sum')
        st.write(pivot)

# –í–∫–ª–∞–¥–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
with t3:
    st.subheader('üõçÔ∏èÔ∏è–°—É–º–º–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞')
    # –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    with st.container(width=300):
        pivot = df.pivot_table(index=['–ö–∞—Ç–µ–≥–æ—Ä–∏–∏'],
                               values=['–°—É–º–º–∞'],
                               aggfunc='sum')
        st.write(pivot)

# –í–∫–ª–∞–¥–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
with t4:
    st.subheader('üõçÔ∏èüçé–°—É–º–º–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç—É')
    # –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    with st.container(width=300):
        pivot = df.pivot_table(index=['–ü—Ä–æ–¥—É–∫—Ç—ã', '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏'],
                               values=['–°—É–º–º–∞'], aggfunc='sum')
        st.write(pivot)

# –í–∫–ª–∞–¥–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
with t5:
    st.subheader('üßæüõçÔ∏è–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞')
    # –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    with st.container(width=300):
        pivot = df.pivot_table(index=['–ö–∞—Ç–µ–≥–æ—Ä–∏–∏'], values=['–°—É–º–º–∞'],
                               aggfunc=['median', 'max', 'min'])
        st.write(pivot)